---
description: Quick reference for Docker command patterns required for Mermin development. Use when running build, test, lint, format, or eBPF analysis commands. Essential for non-Linux environments (macOS) where eBPF code cannot compile natively. Provides the exact docker run syntax with necessary flags (--privileged, mount bindings) for all cargo and bpftool operations.
alwaysApply: false
---
# Docker Commands for Mermin Development

## Required Container Usage

**IMPORTANT**: All eBPF-related commands MUST be run inside the Docker container because eBPF code cannot compile on non-Linux hosts.

## Quick Command Reference

### Build Container

```bash
docker build -t mermin-builder:latest --target builder .
```

### Common Commands

```bash
# Build
docker run -it --privileged --mount type=bind,source=.,target=/app mermin-builder:latest /bin/bash -c "cargo build"

# Test
docker run -it --privileged --mount type=bind,source=.,target=/app mermin-builder:latest /bin/bash -c "cargo test"

# Format
docker run -it --privileged --mount type=bind,source=.,target=/app mermin-builder:latest /bin/bash -c "cargo fmt"

# Lint
docker run -it --privileged --mount type=bind,source=.,target=/app mermin-builder:latest /bin/bash -c "cargo clippy -- -D warnings"

# Clean
docker run -it --privileged --mount type=bind,source=.,target=/app mermin-builder:latest /bin/bash -c "cargo clean"

# Run
docker run -it --privileged --mount type=bind,source=.,target=/app mermin-builder:latest /bin/bash -c "cargo run --release --config 'target."cfg(all())".runner="sudo -E"' -- --config docs/deployment/examples/local/config.hcl"
```

### eBPF Analysis Tools

```bash
# bpftool commands
docker run -it --privileged --mount type=bind,source=.,target=/app mermin-builder:latest /bin/bash -c "bpftool prog list"
docker run -it --privileged --mount type=bind,source=.,target=/app mermin-builder:latest /bin/bash -c "bpftool map list"

# llvm-objdump for binary analysis
docker run -it --privileged --mount type=bind,source=.,target=/app mermin-builder:latest /bin/bash -c "llvm-objdump -d [binary-path]"
```

### Interactive Shell

```bash
# Open interactive shell in container
docker run -it --privileged --mount type=bind,source=.,target=/app mermin-builder:latest /bin/bash
```

## Why Docker is Required

1. **eBPF compilation** requires Linux kernel headers
2. **Aya-ebpf** uses Linux-specific system calls
3. **bpftool** and other eBPF tools are Linux-only
4. Ensures **consistent build environment** across all developers

## Tips for AI Agents

- Always wrap commands in the Docker run pattern shown above
- The `--privileged` flag is required for eBPF operations
- The mount ensures code changes are reflected in the container
- Use `/app` as the working directory inside the container
